BEGIN ISOLATION LEVEL READ COMMITTED;

UPDATE FILM
SET
	RENTAL_RATE = 19.99
WHERE
	FILM_ID = 1;

COMMIT;

BEGIN ISOLATION LEVEL REPEATABLE READ;

UPDATE FILM
SET
	RENTAL_RATE = 1.99
WHERE
	FILM_ID = 1;

COMMIT;

CREATE TABLE DOCTOR_SHIFTS (
	ID SERIAL PRIMARY KEY,
	DOC_NAME VARCHAR(50),
	ON_CALL BOOLEAN
);

INSERT INTO
	DOCTOR_SHIFTS (DOC_NAME, ON_CALL)
VALUES
	('Dr. House', TRUE),
	('Dr. Grey', TRUE);

BEGIN ISOLATION LEVEL SERIALIZABLE;

SELECT
	COUNT(*)
FROM
	DOCTOR_SHIFTS
WHERE
	ON_CALL = TRUE;

UPDATE DOCTOR_SHIFTS
SET
	ON_CALL = FALSE
WHERE
	DOC_NAME = 'Dr. Grey';

COMMIT;

SELECT
	PG_ADVISORY_LOCK(5000);

SELECT
	PG_ADVISORY_UNLOCK(5000);